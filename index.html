<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Svenska Trainer Pro</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; margin: 0; padding: 20px; }
        .container { max-width: 500px; margin: auto; }
        .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin-bottom: 20px; }
        h2 { color: #005293; text-align: center; }
        input { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 16px; }
        button { width: 100%; padding: 12px; background: #005293; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: bold; }
        .nav { display: flex; gap: 5px; margin-bottom: 20px; }
        .nav button { background: #ccc; flex: 1; font-size: 14px; }
        .nav button.active { background: #005293; }
        .status { text-align: center; font-size: 0.9em; color: #666; margin-bottom: 10px; }
        .word-item { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid #eee; }
        .quiz-box { text-align: center; padding: 20px; background: #e7f3ff; border-radius: 8px; }
        .feedback { margin-top: 10px; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <div id="wordCount" class="status">Lade...</div>

    <div class="nav">
        <button id="t1" class="active" onclick="tab('add')">âž• Neu</button>
        <button id="t2" onclick="tab('quiz')">ðŸ§  Ãœben</button>
        <button id="t3" onclick="tab('list')">ðŸ“– Liste</button>
    </div>

    <div id="tabAdd" class="card">
        <h2>Neues Wort</h2>
        <input type="text" id="inDe" placeholder="Deutsch..." onkeypress="if(event.key==='Enter') auto()">
        <button onclick="auto()">Ãœbersetzen & Speichern</button>
        <hr style="margin:20px 0; border:0; border-top:1px solid #eee;">
        <input type="text" id="inEn" placeholder="Englisch">
        <input type="text" id="inSv" placeholder="Schwedisch">
        <button style="background:#28a745" onclick="save()">Manuell Speichern</button>
    </div>

    <div id="tabQuiz" class="card" style="display:none">
        <h2>Vokabel-Trainer</h2>
        <div class="quiz-box">
            <p>Was heiÃŸt auf Schwedisch?</p>
            <h1 id="qText">---</h1>
            <input type="text" id="qAns" placeholder="Antwort...">
            <button onclick="check()">PrÃ¼fen</button>
            <div id="qFeed" class="feedback"></div>
            <button style="background:#666; margin-top:10px" onclick="next()">NÃ¤chstes Wort</button>
        </div>
    </div>

    <div id="tabList" class="card" style="display:none">
        <h2>Dein Wortschatz</h2>
        <div id="listCont"></div>
    </div>
</div>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyB4ViTtin8mGcayWbXX-UtpTpPF5E4u68Q",
        authDomain: "uebersetzer-d-eng-swe.firebaseapp.com",
        projectId: "uebersetzer-d-eng-swe",
        storageBucket: "uebersetzer-d-eng-swe.firebasestorage.app",
        messagingSenderId: "28644987259",
        appId: "1:28644987259:web:ad9844766de2ced699adde",
        measurementId: "G-WDX870XE6B"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    let words = [];
    let current = null;

    function tab(name) {
        document.getElementById('tabAdd').style.display = name==='add'?'block':'none';
        document.getElementById('tabQuiz').style.display = name==='quiz'?'block':'none';
        document.getElementById('tabList').style.display = name==='list'?'block':'none';
        document.getElementById('t1').className = name==='add'?'active':'';
        document.getElementById('t2').className = name==='quiz'?'active':'';
        document.getElementById('t3').className = name==='list'?'active':'';
        if(name==='list') loadList();
        if(name==='quiz') loadQuiz();
    }

    async function auto() {
        const de = document.getElementById('inDe').value;
        if(!de) return;
        const resEn = await fetch(`https://api.mymemory.translated.net/get?q=${encodeURIComponent(de)}&langpair=de|en`);
        const dEn = await resEn.json();
        const resSv = await fetch(`https://api.mymemory.translated.net/get?q=${encodeURIComponent(de)}&langpair=de|sv`);
        const dSv = await resSv.json();
        document.getElementById('inEn').value = dEn.responseData.translatedText;
        document.getElementById('inSv').value = dSv.responseData.translatedText;
        save();
    }

    function save() {
        const de = document.getElementById('inDe').value;
        const en = document.getElementById('inEn').value;
        const sv = document.getElementById('inSv').value;
        if(!de || !sv) return;
        db.collection("words").add({de, en, sv, ts: firebase.firestore.FieldValue.serverTimestamp()}).then(() => {
            document.getElementById('inDe').value = "";
            document.getElementById('inEn').value = "";
            document.getElementById('inSv').value = "";
            count();
        });
    }

    function count() {
        db.collection("words").get().then(s => {
            document.getElementById('wordCount').innerText = s.size + " WÃ¶rter im Speicher ðŸ“š";
            words = s.docs.map(d => ({id: d.id, ...d.data()}));
        });
    }

    function loadList() {
        db.collection("words").orderBy("ts", "desc").get().then(s => {
            let h = "";
            s.forEach(d => {
                const w = d.data();
                h += `<div class="word-item"><span><b>${w.de}</b>: ${w.sv}</span><button style="width:auto; padding:2px 8px; background:red" onclick="del('${d.id}')">X</button></div>`;
            });
            document.getElementById('listCont').innerHTML = h;
        });
    }

    function del(id) { if(confirm("LÃ¶schen?")) db.collection("words").doc(id).delete().then(()=>loadList()); }

    function loadQuiz() { count(); next(); }

    function next() {
        if(words.length === 0) return;
        current = words[Math.floor(Math.random() * words.length)];
        document.getElementById('qText').innerText = current.de;
        document.getElementById('qAns').value = "";
        document.getElementById('qFeed').innerText = "";
    }

    function check() {
        const a = document.getElementById('qAns').value.toLowerCase().trim();
        const correct = current.sv.toLowerCase().trim();
        if(a === correct) document.getElementById('qFeed').innerHTML = "<span style='color:green'>Bravo! Correct! âœ¨</span>";
        else document.getElementById('qFeed').innerHTML = `<span style='color:red'>Leider nein.</span> Richtig: ${current.sv}`;
    }

    count();
</script>
</body>
</html>
